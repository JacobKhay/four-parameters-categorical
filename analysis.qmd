---
title: "Four Parameters Categorical"
format: html
author: "Jacob Khaykin"
execute: 
  echo: false
---


```{r}
library(tidyverse)
library(primer.data)
library(tidymodels)
library(broom)
```



Voting behavior is a categorical outcome often shaped by demographic covariates such as sex. We use the 2020 American National Election Study, which surveyed roughly 2,500 U.S. adults around Election Day, to examine how a respondentâ€™s sex predicts their presidential vote choice. However, because the NES respondents may underrepresent certain demographic groups, our estimated relationship between sex and vote choice could be biased by nonresponse and thus may not generalize to the full electorate. We model voter preference as a multinomial logistic function of respondent sex.



$$
Y_i \;=\; \beta_0 \;+\; \beta_1 X_{1i} \;+\; \beta_2 X_{2i} \;+\;\cdots+\; \beta_p X_{pi} \;+\; \varepsilon_i
$$
$$
\hat{pres\_vote}_i \;=\; 0.438 \;+\; 0.122\,\mathbf{Female}_i
$$

```{r}
#| cache: true
nes_92 <- nes |> 
  filter(year == 1992) |> 
  select(sex, pres_vote) |> 
  drop_na() |> 
  mutate(pres_vote = as.factor(case_when(
    pres_vote == "Democrat"     ~ "Clinton",
    pres_vote == "Republican"   ~ "Bush",
    pres_vote == "Third Party"  ~ "Perot"
  )))

fit_nes <- multinom_reg(engine = "nnet") |>
  fit(pres_vote ~ sex, data = nes_92)

```

```{r}
#| cache: true
library(gt)

tidy(fit_nes, conf.int = TRUE) |>
  select(term, estimate, conf.low, conf.high) |>
  gt() |>
  fmt_number(
    columns = c(estimate, conf.low, conf.high),
    decimals = 3
  ) |>
  cols_label(
    term     = "Coefficient",
    estimate = "Estimate",
    conf.low = "2.5% CI",
    conf.high= "97.5% CI"
  ) |>
  tab_header(
    title = "Multinomial Logit Model Coefficients"
  )

```
